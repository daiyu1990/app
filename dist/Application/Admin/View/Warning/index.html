
<include file="Public:header"/>
<!-- begin #content -->
<div id="content" class="content content_waring" >
	<!-- begin page-header -->
	<h1 class="page-header page_warging"><!--{$title}-->
		安全监控>>报警列表
	</h1>
	<!-- end page-header -->

	<!-- begin row -->
	<div class="row">
		<!-- begin col-12 -->
		<div class="col-md-12">
			<!-- begin panel -->
			<div class="panel panel-inverse">
				<div class="panel-body">
					<div class="row organ-form_waring">
						<div class="clearfix fl oragan_infrl">
							<label class="organ-item">
								<span class="organ-itemt">设备类型：</span>
								<select class="organ-info cenz check_inpldt" >
									<option value="">全部</option>
									<option value="">塔式起重机</option>
									<option value="">施工升降机</option>
								</select>
							</label>
							<label class="organ-item">
								<span class="organ-itemt">产权编号：</span>
								<input type="text" class="organ-info" placeholder="输入产权编号"/>
							</label>
							<label class="organ-item">
								<span class="organ-itemt">终端编号：</span>
								<input type="text" class="organ-info" placeholder="输入终端编号"/>
							</label>
							<label class="organ-item">
								<span class="organ-itemt">在线状态：</span>
								<select class="organ-info cenz check_inpldt" >
									<option value="">全部</option>
									<option value="">在线</option>
									<option value="">离线</option>
								</select>
							</label>
							<label class="organ-item">
								<span class="organ-itemt">所在地区：</span>
								<div class="layui-input-inline">
									<select name="quiz1" class="organ-info check_inpld" >
										<option value="">省（全部）</option>
										<option value="浙江" selected="">浙江省</option>
										<option value="江西">江西省</option>
										<option value="福建">福建省</option>
									</select>
								</div>
								<div class="layui-input-inline">
									<select name="quiz2" class="organ-info check_inpld" >
										<option value="">市（全部）</option>
										<option value="杭州">杭州</option>
										<option value="宁波" disabled="">宁波</option>
										<option value="温州">温州</option>
										<option value="温州">台州</option>
										<option value="温州">绍兴</option>
									</select>
								</div>
							</label>
							<label class="organ-item">
								<span class="organ-itemt">工程名称：</span>
								<input type="text" class="organ-info" placeholder="输入工程名称"/>
							</label>
							<label class="organ-item">
								<a class="refer_equiplist refer">查询</a>
							</label>
						</div>
						<!--<div class="organ-formlt fl oagan_checkt">
							<a class="refer_equiplist refer">查询</a>
						</div>-->
					</div>


					<table id="data-table" class="tj_table waring_table">
						<thead>
						<tr>
							<th class="class_waring" >
								<input type="checkbox" class="check_all"  name="check_all" style="margin-top: 0; vertical-align: inherit;">
								选择
							</th>
							<th class="class_waring" >序号</th>
							<th class="class_waring" >产权编号</th>

						</tr>
						</thead>
						<tbody>
						<?php foreach($info as $k=>$v){ ?>
						<tr id="warging">
							<td style="border-left:1px solid #2164ff !important;">
								<label class="select-checkwaring">
									<input type="checkbox" class="fl check-item_waring" value="{$v.terminal_number}" name="check-item_waring">
								</label>
							</td>
							<td>
								<label class="select-checkwaring">
									<span class="span_waring">{$k+1}</span>
								</label>
							</td>
							<td class="class_warings">
								{$v.cq_num}
								<!--赣AA-T028805-->
							</td>
						</tr>
						<?php }?>
						</tbody>
					</table>

					<div class="table-responsive waring_tablets">
						<table id="data-table1" class="tj_table tj_tables waring_tablet">

							<thead>
							<tr>

								<th class="table_slide warging_widtht">终端编号</th>
								<th class="table_slide">设备类型</th>
								<th class="table_slide">工程名称</th>
								<th class="table_slide warging_width">工地自编号</th>
								<th class="table_slide">施工单位</th>
								<th class="table_slide">操作员</th>
								<th class="table_slide warging_time">数据上传时间</th>
								<th>力矩</th>
								<th>载重</th>
								<th>幅度</th>
								<th>高度</th>
								<th>回转</th>
								<th>风速</th>
								<th>倾角</th>
								<th>一级报警</th>
								<th class="warging_state">在线状态</th>
								<th class="warging_state">是否顶升</th>
								<th class="table_slidet warging_logos">实时数据</th>
								<th class="table_slidet warging_logos">历史工况</th>
								<th class="table_slidet warging_logos">当前位置</th>
								<th class="table_slidet warging_logos">PLC监控</th>
								<th class="table_slidet warging_logos">视频监控</th>

								<th class="table_slidet warging_logos" style="border-right:1px solid #2164ff !important;">重点监控</th>
							</tr>
							</thead>

							<tbody>
							<?php foreach($info as $k=>$v){ ?>
							<tr class="warging">

								<td class="table_slide">{$v.terminal_number}</td>
								<td class="table_slide">{$v.sb_type}</td>
								<td class="table_slide">{$v.project_name}</td>
								<td class="table_slide">{$v.gd_zbh}</td>
								<td class="table_slide">{$v.danwei}</td>
								<td class="table_slide">{$v.czy}</td>
								<td class="table_slide">{$v.time}</td>

								<?php if($v['w_liju']==1): ?>
								<td style="background: #ff7326;color:#fff">{$v.liju}</td>
								<?php elseif($v['y_liju']==1): ?>
								<td style="background: #2164ff;color:#fff">{$v.liju}</td>
								<?php else: ?>
								<td>{$v.liju}</td>
								<?php endif; ?>

								<?php if($v['w_zhongliang']==1): ?>
								<td style="background: #ff7326;color:#fff">{$v.weight}</td>
								<?php elseif($v['y_zhongliang']==1): ?>
								<td style="background: #2164ff;color:#fff">{$v.weight}</td>
								<?php else: ?>
								<td>{$v.weight}</td>
								<?php endif; ?>

								<?php if($v['w_fudu']==1): ?>
								<td style="background: #ff7326;color:#fff">{$v.fudu}</td>
								<?php elseif($v['y_fudu']==1): ?>
								<td style="background: #2164ff;color:#fff">{$v.fudu}</td>
								<?php else: ?>
								<td>{$v.fudu}</td>
								<?php endif; ?>

								<?php if($v['w_gaodu']==1): ?>
								<td style="background: #ff7326;color:#fff">{$v.height}</td>
								<?php elseif($v['y_gaodu']==1): ?>
								<td style="background: #2164ff;color:#fff">{$v.height}</td>
								<?php else: ?>
								<td>{$v.height}</td>
								<?php endif; ?>

								<?php if($v['w_huizhuan']==1): ?>
								<td style="background: #ff7326;color:#fff">{$v.hz_jd}</td>
								<?php elseif($v['y_huizhuan']==1): ?>
								<td style="background: #2164ff;color:#fff">{$v.hz_jd}</td>
								<?php else: ?>
								<td>{$v.hz_jd}</td>
								<?php endif; ?>

								<?php if($v['w_fengsu']==1): ?>
								<td style="background: #ff7326;color:#fff">{$v.fengsu}</td>
								<?php elseif($v['y_fengsu']==1): ?>
								<td style="background: #2164ff;color:#fff">{$v.fengsu}</td>
								<?php else: ?>
								<td>{$v.fengsu}</td>
								<?php endif; ?>


								<!--<td>{$v.db_yj}</td>-->
								<td>-</td>


								<?php if($v['is_top']==1): ?>
								<td style="background: #e84e40;color:#fff">{$v.top_warning}</td>
								<?php else: ?>
								<td>{$v.top_warning}</td>
								<?php endif; ?>


								<td>{$v.ol}</td>
								<td>{$v.work_type}</td>
								<td class="table_slidet">
									<a href="JavaScript:;" id="organ_check" class="lyDataNow">
										<i class="real_date"></i>
									</a>
								</td>
								<td class="table_slidet"><a href="" id="organ_check"><i class="working_condition"></i></a></td>

								<td class="table_slidet">
									<a href="" id="organ_check"><i class="current_position"></i></a>

								</td>

								<td class="table_slidet"><a href="" id="organ_check"><i class="PLCmonitoring"></i></a></td>
								<td class="table_slidet"><a href="" id="organ_check"><i class="video_surveillance"></i></a></td>
								<td class="table_slidet" style="border-right:1px solid #2164ff !important;">
									<a href="" id="organ_check"><i class="key_monitoring"></i></a>
								</td>
							</tr>
							<?php } ?>
							</tbody>
						</table>

					</div>

					<!--分页page-->
					<div class="paging_lister">

						<!--<ul class="pagination pagination-sm">-->
							<!--<li>-->
								<!--<a href="#" aria-label="Previous">-->
									<!--<span aria-hidden="true">&laquo;</span>-->
								<!--</a>-->
							<!--</li>-->
							<!--<li><a href="#" style="background: #2164ff; color:#fff;">1</a></li>-->
							<!--<li><a href="#">2</a></li>-->
							<!--<li><a href="#">3</a></li>-->
							<!--<li><a href="#">4</a></li>-->
							<!--<li><a href="#">5</a></li>-->
							<!--<li>-->
								<!--<a href="#" aria-label="Next">-->
									<!--<span aria-hidden="true">&raquo;</span>-->
								<!--</a>-->
							<!--</li>-->
						<!--</ul>-->

						<!--<p style="margin-top:5px;float:right;">每页10条，共{$count}条</p>-->
					</div>
				</div>
				<!-- end panel-body -->
				<hr class="panel_footer">
				<!--<div class="equip_title">-->

				<!--<i class="equip_i"></i>-->

				<!--<span class="alarm_info">报警信息统计图</span>-->
				<!--</div>-->
				<hr style="margin-bottom:12px;"></hr>
				<div class="Columnar_map row">
					<div class="equip_title" style="float: left; margin-left: 25px; margin-top: 26px;">

						<i class="equip_i"></i>

						<span class="alarm_info">报警信息统计图</span>
					</div>
					<div style="float:right; margin-right:50px;">
						<ul class="pagination pagination-sm">
							<li><a class="time warging_times" href="" for="1" data="1" style="background: #2164ff; color:#fff ; ">日</a ></li>
							<li><a class="time warging_times" href="" data="7">周</a ></li>
							<li><a class="time warging_times" href="" data="30">月</a ></li>
						</ul>
					</div>
				</div>

				<!--柱状统计图-->
				<div class="Columnar_map row">
					<div class="col-md-5">
						<div class="Columnar_con" id="Columnar_con">
							<p class="Columnar_title">一级报警统计图</p>
							<div class="Columnar_chart" id="Columnar_chart" style="height: 400px;"></div>
						</div>
					</div>
					<div class="col-md-4">
						<div class="Columnar_con" id="Columnar_con">

							<p class="Columnar_title Columnar_titles">报警统计图</p>
							<div class="Columnar_chart " id="Columnar_chartt" style="height: 400px;"></div>
						</div>
					</div>
					<div class="col-md-3">
						<div class="Columnar_con" id="Columnar_con">

							<p class="Columnar_title Columnar_titlet" style="background: #2164ff !important;">报警分类统计图</p>
							<div class="Columnar_chart " style="height: 400px;" id="Columnar_charts"></div>
						</div>
					</div>

				</div>

				<div class="Columnar_map row">

					<div class="col-md-12" style="margin-top:20px">
						<div class="Columnar_con" id="Columnar_con">

							<h1 style="font-size: 14px;margin-bottom: 20px"><strong>报警趋势</strong></h1>
							<div class="Columnar_chart " style="height:400px; " id="Columnar_charta"></div>
						</div>
					</div>
				</div>

			</div>
		</div>
		<!-- end panel -->
	</div>
	<!-- end col-12 -->
</div>
<!-- end row -->
</div>
<!-- end #content -->



<include file="Public:footer"/>

<script>

	$(document).on('click','.check_all',function(){

		if($(this).is(':checked')){
			//选中
//			array.splice(0,array.length);
			$(".check-item_waring").each(function(){
				$(this).attr("checked", true);

			});
		}else{
			//未选中
//			array.splice(0,array.length);
			$(".check-item_waring").each(function(){
				$(this).attr("checked", false);
			});
		}

		get_warning();

	})

	$(document).on('click','.check-item_waring',function(){

		var all = 1;
		$(".check-item_waring").each(function(){
			if($(this).is(':checked')) {

			}else{
				all = 0;
			}
		});

		if(all == 1){
			$('.check_all').attr("checked", true);
		}else{
			$('.check_all').attr("checked", false);
		}

		get_warning();



	});


	$(document).on('click','.time',function(){

		$('.time').each(function(){
			$(this).removeAttr('for');
			$(this).css('background','#fff');
			$(this).css('color','#333');

		});

		$(this).attr('for','1');
		$(this).css('background','#2164ff');
		$(this).css('color','#fff');

		get_warning();
		return false;

	})



	function get_warning(){

		var terminal = '';

		$('.check-item_waring').each(function(){
			if($(this).is(':checked')) {
				terminal += $(this).val()+',';
			}
		})

		var time = '';
		$('.time').each(function(){
			if($(this).attr('for')==1){
				time = $(this).attr('data');

			}
		});

		if(terminal!=''){

			mychart.showLoading();
			mychartt.showLoading();
			mycharts.showLoading();
			mycharta.showLoading();

			$.ajax({
				url:"{:U('Admin/Warning/index')}",
				dataType:'json',
				type:'post',
				data:{
					'do':'get_warning',
					'terminal':terminal,
					'time':time,
				},
				success:function(e){
					mychart.hideLoading();
					mychartt.hideLoading();
					mycharts.hideLoading();
					mycharta.hideLoading();

					mychart.setOption({
						series : [
							{
								name:'数量',
								type:'bar',
								barWidth: '20px',
								data:[e.top.liju, e.top.zhongliang, e.top.fudu, e.top.gaodu, e.top.huizhuan, e.top.fengsu, e.top.bianfu, e.top.qisheng, e.top.top_huizhuan, e.top.chuizhi, e.top.niutui],
								itemStyle: {
									normal: {
										label: {
											show: true,
											position: 'top',
											textStyle: {
												color: '#615a5a'
											},
											formatter:function(params){
												if(params.value==0){
													return '';
												}else
												{
													return params.value;
												}
											}
										}
									}
								}
							}
						]
					});

					mychartt.setOption({
						series : [
							{
								name:'数量',
								type:'bar',
								barWidth: '20px',
								data:[   ],
								data:[e.warning.liju, e.warning.zhongliang, e.warning.fudu, e.warning.gaodu, e.warning.huizhuan, e.warning.fengsu, 0],
								itemStyle: {
									normal: {
										label: {
											show: true,
											position: 'top',
											textStyle: {
												color: '#615a5a'
											},
											formatter:function(params){
												if(params.value==0){
													return '';
												}else
												{
													return params.value;
												}
											}
										}
									}
								}
							}
						]
					});

					mycharts.setOption({
						series : [
							{
								name:'数量',
								type:'bar',
								barWidth: '30%',
								data:[e.top.niutui+e.top.bianfu+e.top.fengsu+e.top.qisheng+e.top.top_huizhuan+e.top.zhongliang+e.top.liju+e.top.fudu+e.top.gaodu+e.top.huizhuan+e.top.chuizhi,e.warning.fudu+ e.warning.gaodu+ e.warning.fengsu+ e.warning.huizhuan+ e.warning.zhongliang+ e.warning.liju],
								itemStyle: {
									normal: {
										label: {
											show: true,
											position: 'top',
											textStyle: {
												color: '#615a5a'
											},
											formatter:function(params){
												if(params.value==0){
													return '';
												}else
												{
													return params.value;
												}
											}
										}
									}
								}
							}
						]
					});

					if(e.type=='day') {
						console.log(e);
						mycharta.setOption({
							xAxis: [
								{
									type: 'category',
									boundaryGap: false,
									data: ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23']
								}
							],
							series: [
								{
									name: '一级报警',
									type: 'line',

									itemStyle: {
										normal: {
											lineStyle: {
												color: '#e84e40'
											}
										}
									},
									label: {
										normal: {
											show: true,
											position: 'top'
										}
									},
//									areaStyle: {normal: {color: "red", opacity: "0.65"}},
									data: [
										e.time[0].top,
										e.time[1].top,
										e.time[2].top,
										e.time[3].top,
										e.time[4].top,
										e.time[5].top,
										e.time[6].top,
										e.time[7].top,
										e.time[8].top,
										e.time[9].top,
										e.time[10].top,
										e.time[11].top,
										e.time[12].top,
										e.time[13].top,
										e.time[14].top,
										e.time[15].top,
										e.time[16].top,
										e.time[17].top,
										e.time[18].top,
										e.time[19].top,
										e.time[20].top,
										e.time[21].top,
										e.time[22].top,
										e.time[23].top,
									]
								},

								{
									name: '报警',
									type: 'line',

									label: {
										normal: {
											show: true,
											position: 'top'
										}
									},
									itemStyle: {
										normal: {
											lineStyle: {
												color: '#ff7326'
											}
										}
									},
//									areaStyle: {normal: {color: "#ff7326", opacity: "0.65"}},
									data: [
										e.time[0].war,
										e.time[1].war,
										e.time[2].war,
										e.time[3].war,
										e.time[4].war,
										e.time[5].war,
										e.time[6].war,
										e.time[7].war,
										e.time[8].war,
										e.time[9].war,
										e.time[10].war,
										e.time[11].war,
										e.time[12].war,
										e.time[13].war,
										e.time[14].war,
										e.time[15].war,
										e.time[16].war,
										e.time[17].war,
										e.time[18].war,
										e.time[19].war,
										e.time[20].war,
										e.time[21].war,
										e.time[22].war,
										e.time[23].war,
									]
								}
							]

						});
					}else{


						if(e.type == 'week'){

							mycharta.setOption({
								yAxis : [
									{
										type : 'value'
									}
								],
								xAxis: [
									{
										type: 'category',

										boundaryGap: false,
										data: [
											e.time[0].riqi,
											e.time[1].riqi,
											e.time[2].riqi,
											e.time[3].riqi,
											e.time[4].riqi,
											e.time[5].riqi,
											e.time[6].riqi

										]
									}
								],
								series: [
									{
										name: '一级报警',
										type: 'line',

										itemStyle: {
											normal: {
												lineStyle: {
													color: '#e84e40'
												}
											}
										},
										label: {
											normal: {
												show: true,
												position: 'top'
											}
										},
//										areaStyle: {normal: {color: "red", opacity: "0.65"}},
										data: [
											e.time[0].top,
											e.time[1].top,
											e.time[2].top,
											e.time[3].top,
											e.time[4].top,
											e.time[5].top,
											e.time[6].top
										]
									},

									{
										name: '报警',
										type: 'line',

										label: {
											normal: {
												show: true,
												position: 'top'
											}
										},
										itemStyle: {
											normal: {
												lineStyle: {
													color: '#ff7326'
												}
											}
										},
//										areaStyle: {normal: {color: "#ff7326", opacity: "0.65"}},
										data: [
											e.time[0].war,
											e.time[1].war,
											e.time[2].war,
											e.time[3].war,
											e.time[4].war,
											e.time[5].war,
											e.time[6].war
										]
									}
								]

							});
						}

						if(e.type == 'month'){

							mycharta.setOption({

								yAxis : [
									{
										type : 'value'
									}
								],
								xAxis: [
									{
										type: 'category',
										axisLabel:{
											interval:0
										},
										axisLabel: {
											interval:0,
											rotate:-30,
										},
										boundaryGap: false,
										data: [
											e.time[0].riqi,
											e.time[1].riqi,
											e.time[2].riqi,
											e.time[3].riqi,
											e.time[4].riqi,
											e.time[5].riqi,
											e.time[6].riqi,
											e.time[7].riqi,
											e.time[8].riqi,
											e.time[9].riqi,
											e.time[10].riqi,
											e.time[11].riqi,
											e.time[12].riqi,
											e.time[13].riqi,
											e.time[14].riqi,
											e.time[15].riqi,
											e.time[16].riqi,
											e.time[17].riqi,
											e.time[18].riqi,
											e.time[19].riqi,
											e.time[20].riqi,
											e.time[21].riqi,
											e.time[22].riqi,
											e.time[23].riqi,
											e.time[24].riqi,
											e.time[25].riqi,
											e.time[26].riqi,
											e.time[27].riqi,
											e.time[28].riqi,
											e.time[29].riqi,
											e.time[30].riqi

										]
									}
								],
								series: [
									{
										name: '一级报警',
										type: 'line',

										itemStyle: {
											normal: {
												lineStyle: {
													color: '#e84e40'
												}
											}
										},
										label: {
											normal: {
												show: true,
												position: 'top'
											}
										},
//									areaStyle: {normal: {color: "red", opacity: "0.65"}},
										data: [
											e.time[0].top,
											e.time[1].top,
											e.time[2].top,
											e.time[3].top,
											e.time[4].top,
											e.time[5].top,
											e.time[6].top,
											e.time[7].top,
											e.time[8].top,
											e.time[9].top,
											e.time[10].top,
											e.time[11].top,
											e.time[12].top,
											e.time[13].top,
											e.time[14].top,
											e.time[15].top,
											e.time[16].top,
											e.time[17].top,
											e.time[18].top,
											e.time[19].top,
											e.time[20].top,
											e.time[21].top,
											e.time[22].top,
											e.time[23].top,
											e.time[24].top,
											e.time[25].top,
											e.time[26].top,
											e.time[27].top,
											e.time[28].top,
											e.time[29].top,
											e.time[30].top
										]
									},

									{
										name: '报警',
										type: 'line',

										label: {
											normal: {
												show: true,
												position: 'top'
											}
										},
										itemStyle: {
											normal: {
												lineStyle: {
													color: '#ff7326'
												}
											}
										},
//									areaStyle: {normal: {color: "#ff7326", opacity: "0.65"}},
										data: [
											e.time[0].war,
											e.time[1].war,
											e.time[2].war,
											e.time[3].war,
											e.time[4].war,
											e.time[5].war,
											e.time[6].war,
											e.time[7].war,
											e.time[8].war,
											e.time[9].war,
											e.time[10].war,
											e.time[11].war,
											e.time[12].war,
											e.time[13].war,
											e.time[14].war,
											e.time[15].war,
											e.time[16].war,
											e.time[17].war,
											e.time[18].war,
											e.time[19].war,
											e.time[20].war,
											e.time[21].war,
											e.time[22].war,
											e.time[23].war,
											e.time[24].war,
											e.time[25].war,
											e.time[26].war,
											e.time[27].war,
											e.time[28].war,
											e.time[29].war,
											e.time[30].war
										]
									}
								]

							})

						}






					}
				}
			})
		}else{

			mychart.setOption({
				series : [
					{
						name:'数量',
						type:'bar',
						barWidth: '20px',
						data:[0,0,0,0,0,0,0,0,0,0,0 ],
						itemStyle: {
							normal: {
								label: {
									show: true,
									position: 'top',
									textStyle: {
										color: '#615a5a'
									},
									formatter:function(params){
										if(params.value==0){
											return '';
										}else
										{
											return params.value;
										}
									}
								}
							}
						}
					}
				]
			});


			mychartt.setOption({
				series : [
					{
						name:'数量',
						type:'bar',
						barWidth: '20px',
						data:[0, 0, 0, 0, 0, 0, 0],
						itemStyle: {
							normal: {
								label: {
									show: true,
									position: 'top',
									textStyle: {
										color: '#615a5a'
									},
									formatter:function(params){
										if(params.value==0){
											return '';
										}else
										{
											return params.value;
										}
									}
								}
							}
						}
					}
				]
			});

			mycharts.setOption({
				series : [
					{
						name:'数量',
						type:'bar',
						barWidth: '30%',
						data:[0,0],
						itemStyle: {
							normal: {
								label: {
									show: true,
									position: 'top',
									textStyle: {
										color: '#615a5a'
									},
									formatter:function(params){
										if(params.value==0){
											return '';
										}else
										{
											return params.value;
										}
									}
								}
							}
						}
					}
				]
			});


			mycharta.setOption({

				xAxis : [
					{
						type : 'category',
						boundaryGap : false,
						data : ['0','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23']
					}
				],
				series : [
					{
						name:'一级报警',
						type:'line',

//						stack: '总量',
						itemStyle : {
							normal : {
								lineStyle:{
									color:'#e84e40'
								}
							}
						},
						label: {
							normal: {
								show: true,
								position: 'top'
							}
						},
//						areaStyle: {normal: {color:"red",opacity :"0.65"}},
						data:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
					},

					{
						name:'报警',
						type:'line',
						smooth: true,
//						stack: '总量',
						label: {
							normal: {
								show: true,
								position: 'top'
							}
						},
						itemStyle : {
							normal : {
								lineStyle:{
									color:'#ff7326'
								}
							}
						},
//						areaStyle: {normal: {color:"#ff7326",opacity :"0.65"}},
						data:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
					}
				]
			});

		}

	}

	window.onload=function(){

		window.setInterval("getData()",4000);
	}

	function getData(){


		var ter = '';
		$('.check-item_waring').each(function(){
			ter += ',' + $(this).val();
		})

		ter = ter.replace(',','');

		$.ajax({
			url:"{:U('Admin/Warning/index')}",
			dataType:'json',
			type:'post',
			data:{
				'do':'refresh',
				'ter':ter
			},
			success:function(e){
				var html = '<thead>'+
						'<tr>'+

						'<th class="table_slide warging_widtht">终端编号</th>'+
						'<th class="table_slide">设备类型</th>'+
						'<th class="table_slide">工程名称</th>'+
						'<th class="table_slide warging_width">工地自编号</th>'+
						'<th class="table_slide">施工单位</th>'+
						'<th class="table_slide">操作员</th>'+


						'<th class="table_slide warging_time">数据上传时间</th>'+
						'<th>力矩</th>'+
						'<th>载重</th>'+
						'<th>幅度</th>'+
						'<th>高度</th>'+
						'<th>回转</th>'+
						'<th>风速</th>'+
						'<th>倾角</th>'+
						'<th>一级报警</th>'+
						'<th class="warging_state">在线状态</th>'+
						'<th class="warging_state">是否顶升</th>'+
						'<th class="table_slidet warging_logos">实时数据</th>'+
						'<th class="table_slidet warging_logos">历史工况</th>'+
						'<th class="table_slidet warging_logos">当前位置</th>'+
						'<th class="table_slidet warging_logos">PLC监控</th>'+
						'<th class="table_slidet warging_logos">视频监控</th>'+
						'<th class="table_slidet warging_logos" style="border-right:1px solid #2164ff !important;">重点监控</th>'+
						'</tr>'+
						'</thead>'+

						'<tbody>';

				var i=0;
				for(i=0;i< e.length;i++) {
					html += '<tr id="warging">' +

							'<td class="table_slide">' + e[i].terminal_number + '</td>' +
							'<td class="table_slide">' + e[i].sb_type + '</td>' +
							'<td class="table_slide">' + e[i].project_name + '</td>' +
							'<td class="table_slide">' + e[i].gd_zbh + '</td>' +
							'<td class="table_slide">' + e[i].danwei + '</td>' +
							'<td class="table_slide">' + e[i].czy + '</td>' +
							'<td class="table_slide">' + e[i].time + '</td>';

					if(e[i].w_liju==1){
						html += '<td style="background: #ff7326;color:#fff;">' + e[i].liju + '</td>';
					}else if(e[i].y_liju==1){
						html += '<td style="background: #2164ff;color:#fff;">' + e[i].liju + '</td>';
					}else{
						html += '<td>' + e[i].liju + '</td>';
					}

					if(e[i].w_zhongliang==1){
						html += '<td style="background: #ff7326;color:#fff;">' + e[i].weight + '</td>';
					}else if(e[i].y_zhongliang==1){
						html += '<td style="background: #2164ff;color:#fff;">' + e[i].weight + '</td>';
					}else{
						html += '<td>' + e[i].weight + '</td>';
					}

					if(e[i].w_fudu==1){
						html += '<td style="background: #ff7326;color:#fff;">' + e[i].fudu + '</td>';
					}else if(e[i].y_fudu==1){
						html += '<td style="background: #2164ff;color:#fff;">' + e[i].fudu + '</td>';
					}else{
						html += '<td>' + e[i].fudu + '</td>';
					}

					if(e[i].w_gaodu==1){
						html += '<td style="background: #ff7326;color:#fff;">' + e[i].height + '</td>';
					}else if(e[i].y_gaodu==1){
						html += '<td style="background: #2164ff;color:#fff;">' + e[i].height + '</td>';
					}else{
						html += '<td>' + e[i].height + '</td>';
					}

					if(e[i].w_huizhuan==1){
						html += '<td style="background: #ff7326;color:#fff;">' + e[i].hz_jd + '</td>';
					}else if(e[i].y_huizhuan==1){
						html += '<td style="background: #2164ff;color:#fff;">' + e[i].hz_jd + '</td>';
					}else{
						html += '<td>' + e[i].hz_jd + '</td>';
					}


					if(e[i].w_fengsu==1){
						html += '<td style="background: #ff7326;color:#fff;">' + e[i].fengsu + '</td>';
					}else if(e[i].y_fengsu==1){
						html += '<td style="background: #2164ff;color:#fff;">' + e[i].fengsu + '</td>';
					}else{
						html += '<td>' + e[i].fengsu + '</td>';
					}

					html += '<td>' + '-' + '</td>';

					if(e[i].is_top==1) {
						html += '<td style="background: #e84e40;color:#fff;">' + e[i].top_warning + '</td>';
					}else{
						html += '<td>' + e[i].top_warning + '</td>';
					}

					html += '<td>' + e[i].ol + '</td>' +
							'<td>' + e[i].work_type + '</td>' +
							'<td class="table_slidet"><a href="" id="organ_check"><i class="real_date"></i></a></td>' +
							'<td class="table_slidet"><a href="" id="organ_check"><i class="working_condition"></i></a></td>' +
							'<td class="table_slidet">' +
							'<a href="" id="organ_check"><i class="current_position"></i></a>' +

							'</td>' +

							'<td class="table_slidet"><a href="" id="organ_check"><i class="PLCmonitoring"></i></a></td>' +
							'<td class="table_slidet"><a href="" id="organ_check"><i class="video_surveillance"></i></a></td>' +
							'<td class="table_slidet" style="border-right:1px solid #2164ff !important;">' +
							'<a href="" id="organ_check"><i class="key_monitoring"></i></a>' +
							'</td>' +
							'</tr>';

				}

				html += '</tbody>';

				$('#data-table1').html(html);


			}
		})
	};

	//一级报警统计图
	var mychart=echarts.init(document.getElementById('Columnar_chart'));
	mychart.title = '坐标轴刻度与标签对齐';

	option = {

		color: ['#2164ff'],
		tooltip : {
			trigger: 'axis',
			axisPointer : {            // 坐标轴指示器，坐标轴触发有效
				type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
			}
		},
		toolbox: {
			feature: {
				saveAsImage: {}
			}
		},
		grid: {
			left: '3%',
			right: '15%',
			bottom: '15%',
			containLabel: true
		},
		xAxis : [
			{
				type : 'category',
				data : ['力矩限制器失效', '重量限制器失效', '幅度限位器失效', '高度限位器失效', '回转限位器失效', '顶升风速报警', '顶升变幅作业报警','顶升起升作业报警','顶升回转作业报警','垂直度报警','未安装牛腿销轴报警'],
				axisTick: {
					alignWithLabel: true
				},
				axisLabel: {
					interval:0,
					rotate:-30,
				}
			}
		],
		yAxis : [
			{
				type : 'value'
			}
		],
		series : [
			{
				name:'直接访问',
				type:'bar',
				barWidth: '20px',
				data:[0, 0, 0, 0, 0, 0, 0,0,0,0,0],
				itemStyle: {
					normal: {
						label: {
							show: true,
							position: 'top',
							textStyle: {
								color: '#615a5a'
							},
							formatter:function(params){
								if(params.value==0){
									return '';
								}else
								{
									return params.value;
								}
							}
						}
					}
				}
			}
		]
	};
	mychart.setOption(option);
	$(window).resize(function(){
		mychart.resize();
	});
	//报警分类统计
	var mychartt=echarts.init(document.getElementById('Columnar_chartt'));
	mychartt.title = '坐标轴刻度与标签对齐';

	option = {

		color: ['#2164ff'],
		tooltip : {
			trigger: 'axis',
			axisPointer : {            // 坐标轴指示器，坐标轴触发有效
				type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
			}
		},
		toolbox: {
			feature: {
				saveAsImage: {}
			}
		},
		grid: {
			left: '3%',
			right: '15%',
			bottom: '15%',
			containLabel: true
		},
		xAxis : [
			{
				type : 'category',
				data : ['力矩报警', '载重报警', '幅度限位报警', '高度限位报警','回转限位报警', '风速报警', '倾角报警'],
				axisTick: {
					alignWithLabel: true
				},
				axisLabel: {
					interval:0,
					rotate:-30,
				}
			}
		],
		yAxis : [
			{
				type : 'value'
			}
		],
		series : [
			{
				name:'直接访问',
				type:'bar',
				barWidth: '20px',
				data:[0, 0, 0, 0, 0, 0, 0],
				itemStyle: {
					normal: {
						label: {
							show: true,
							position: 'top',
							textStyle: {
								color: '#615a5a'
							},
							formatter:function(params){
								if(params.value==0){
									return '';
								}else
								{
									return params.value;
								}
							}
						}
					}
				}
			}
		]
	};
	mychartt.setOption(option);
	$(window).resize(function(){
		mychartt.resize();
	});
	//报警分布统计图
	var mycharts=echarts.init(document.getElementById('Columnar_charts'));
	mycharts.title = '坐标轴刻度与标签对齐';

	option = {

		color: ['#2164ff'],
		tooltip : {
			trigger: 'axis',
			axisPointer : {            // 坐标轴指示器，坐标轴触发有效
				type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
			}
		},
		toolbox: {
			feature: {
				saveAsImage: {}
			}
		},
		grid: {
			left: '3%',
			right: '15%',
			bottom: '15%',
			containLabel: true,
		},
		xAxis : [
			{
				type : 'category',
				data : ['一级报警', '报警'],
				axisTick: {
					alignWithLabel: true
				},
				axisLabel: {
					interval:0,
					rotate:-30,
				}
			}
		],
		yAxis : [
			{
				type : 'value'
			}
		],
		series : [
			{
				name:'直接访问',
				type:'bar',
				barWidth: '30%',
				data:[0, 0],
				itemStyle: {
					normal: {
						label: {
							show: true,
							position: 'top',
							textStyle: {
								color: '#615a5a'
							},
							formatter:function(params){
								if(params.value==0){
									return '';
								}else
								{
									return params.value;
								}
							}
						}
					}
				}
			}
		]
	};
	mycharts.setOption(option);
	$(window).resize(function(){
		mycharts.resize();
	});

	//报警趋势
	var mycharta=echarts.init(document.getElementById('Columnar_charta'));
	mycharta.title = '坐标轴刻度与标签对齐';

	option = {
		title: {
			text: ''
		},
		tooltip : {
			trigger: 'axis',
			axisPointer: {
				type: 'cross',
				label: {
					backgroundColor: '#6a795'
				}
			}
		},
		legend: {
			data:[
				'一级报警', '报警']
		},
		toolbox: {
			feature: {
				saveAsImage: {}
			}
		},
		grid: {
			left: '3%',
			right: '4%',
			bottom: '3%',
			containLabel: true
		},
		xAxis : [
			{
				type : 'category',
				boundaryGap : false,
				data : ['0','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23']
			}
		],
		yAxis : [
			{
				type : 'value'
			}
		],
		series : [
			{
				name:'一级报警',
				type:'line',
				smooth: true,
				// stack: '总量',
				itemStyle : {
					normal : {
						lineStyle:{
							color:'#e84e40'
						}
					}
				},
				label: {
					normal: {
						show: true,
						position: 'top'
					}
				},
//					areaStyle: {normal: {color:"red",opacity :"0.65"}},
				data:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
			},

			{
				name:'报警',
				type:'line',
				smooth: true,
				// stack: '总量',
				label: {
					normal: {
						show: true,
						position: 'top'
					}
				},
				itemStyle : {
					normal : {
						lineStyle:{
							color:'#ff7326'
						}
					}
				},
//					areaStyle: {normal: {color:"#ff7326",opacity :"0.65"}},
				data:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
			}
		]
	};
	mycharta.setOption(option);
	$(window).resize(function(){
		mycharta.resize();
	});
</script>