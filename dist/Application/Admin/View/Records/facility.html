
    <h1 class="page-header">{$title}</h1>
    <!-- end page-header -->

    <!-- begin row -->
    <div class="row">
        <!-- begin col-12 -->
        <div class="col-md-12">
            <!-- begin panel -->
            <div class="panel panel-inverse">
                <div class="panel-body">
                    <div class="row manage-search">
                        <div class="col-md-6 btnArea">
                            <div class="dropdown">
                                <select class="form-control del_status">
                                    <option value=""><a href="javascript:;;">选择设备类型</a></option>
                                    <volist name="type" id="vo">
                                        <option value="{$vo.id}" {$vo.id == 0?'selected':''}><a href="javascript:;;">{$vo.name}</a></option>
                                    </volist>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6 form-group" id='manage-right'></div>
                    </div>
                    <table id="data-table" class="table table-striped table-bordered">
                        <thead>
                        <th>ID</th>
                        <th>产权编号</th>
                        <th>设备类型</th>
                        <th>设备编号</th>
                        <th>设备型号</th>
                        <th>制造单位</th>
                        <th>登记日期</th>
                        <th>操作</th>
                        </thead>
                    </table>
                </div>
            </div>
            <!-- end panel -->
        </div>
        <!-- end col-12 -->
    </div>
    <!-- end row -->
</div>
<!-- end #content -->

<script>
    var Page = {
        init: function(){
            this.bind();
            this.renderTable();
        },
        bind: function(){
            var _this = this;
            //状态
            $(document).on('change', '.del_status', function() {
                _this.start_stop = $(this).val();
                $('#dropdownMenu2').text($(this).text());
                _this.renderTable();
            })
            $(document).on('click','.facility',function(){
                var href = $(this).attr('href');
                $.ajax({
                    url:href,
                    type:'get',
                    dataType:'json',
                    success:function(e){
                        layer.closeAll();
                        $('#facility_id').val(e.mid);
                        $('#equity_number').text(e.equity_number);
                        $('#facility_number').text(e.facility_number);
                        $('#facility_type').text(e.facility_type);
                        $('#factory_number').text(e.factory_number);
                        $('#factory_date').text(e.factory_date);
                        $('#buy_date').text(e.buy_date);
                        $('#equity_certification_number').text(e.equity_certification_number);
                        $('#facility_source').text(e.facility_source);
                        $('#facility_model_number').text(e.facility_model_number);
                        $('#make_company').text(e.make_company);
                        $('#manufacturing_licence_number').text(e.manufacturing_licence_number);
                        $('#supervise_verify_number').text(e.supervise_verify_number);
                        $('#load_moment').text(e.load_moment);
                        $('#rated_load').text(e.rated_load);
                        $('#amplitude_peak').text(e.amplitude_peak);
                        $('#rated_payload_capacity').text(e.rated_payload_capacity);
                        $('#largest_free_height').text(e.largest_free_height);
                        $('#largest_raising_height').text(e.largest_raising_height);
                        $('#gauge').text(e.gauge);
                        $('#wheel_base').text(e.wheel_base);
                        $('#chassis_type').text(e.chassis_type);
                        $('#luffing_type').text(e.luffing_type);
                        $('#trolley_travlling_speed').text(e.trolley_travlling_speed);
                        $('#largest_raising_speed').text(e.largest_raising_speed);
                        $('#decline_speed').text(e.decline_speed);
                        $('#turning_speed').text(e.turning_speed);
                        $('#running_speed').text(e.running_speed);
                        $('#remark').text(e.remark);

                    }

                })
                return false;
            })
            $(document).on('click','#addcode',function(){
                var that = $(this);
                $.ajax({
                    url : that.attr('href'),
                    success:function(result){
                        _this.openLayer(that.text(),result,'600px','400px');
                    }
                })
                return false;
            })
        },
        openLayer: function(title,html,width,height){
            if(width == ''){
                width = '1000px';
            }
            if(height == ''){
                height = '650px';
            }
            layer.open({
                type: 1,
                title: title,
                area: [width, height], //宽高
                closeBtn: 1, //不显示关闭按钮
                shift: 2,
                shadeClose: true, //开启遮罩关闭
                content: html
            });
        },
        start_stop:0,
        renderTable: function(){
//            layer.load(1, {
//                shade: [0.1,'#fff'] //0.1透明度的白色背景
//            });
            var _this = this;
            if(this.tableInit){
                $('#data-table').DataTable().ajax.reload();
                return;
            }
            this.tableInit = true;
            _this.table = $('#data-table').DataTable({
                        "ajax": {
                            url : '{:U('Records/facility',array('do'=>'listTableData'))}',
                        data: function(){
                            return {
                                start_stop: _this.start_stop,
                            }
                        }
                    },
                    "dom":'f<t>ip',
                //'searching':true,
                //多语言配置
                    "language": Base.oLanguage,
                //默认排序列
                //"aaSorting": [[ 3, "asc" ]],
                    "drawCallback": function(){
//                layer.closeAll();
            },
            // "searching":false,
            // "deferLoading":10000,
            "initComplete":function(row, data, start, end, display){
                $('#manage-right').append($('#data-table_filter'));
            },
        });


        }
    }
    $(document).ready(function() {
        Page.init();
    });
</script>

